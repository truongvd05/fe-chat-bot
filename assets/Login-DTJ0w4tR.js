import{u as y,a as b,r as c,b as v,c as C,j as e,I as n,B as S,N as i,o as E,s as L,d as q,e as m}from"./index-BMfXngdd.js";import{C as I,a as V,b as _,c as B}from"./card-CKs96dR_.js";const F=q({email:m().required("Vui lòng nhập Email"),password:m().required("Vui lòng nhập mật khẩu")});function H(){const d=y(),u=b(),[t,p]=c.useState(!1),{register:o,handleSubmit:h,setError:x,watch:l,clearErrors:g,formState:{errors:s}}=v({resolver:E(F)}),f=l("email"),w=l("password");c.useEffect(()=>{s.err&&g("err")},[f,w]);const[j,{isLoading:N,error:P}]=C(),k=async r=>{try{const a=await j({email:r.email,password:r.password}).unwrap();console.log("Login success:",a),localStorage.setItem("access_token",a.token.access_token),localStorage.setItem("refresh_token",a.token.refresh_token),u(L(a.user)),d("/home")}catch(a){console.log("Login failed:",a),x("err",{type:"manual",message:a?.data?.error||"Đăng nhập thất bại"})}};return e.jsxs(I,{className:"w-full max-w-sm m-auto",children:[e.jsx(V,{children:e.jsx(_,{className:"m-auto",children:"Log in with your account"})}),e.jsxs("form",{className:"flex flex-col items-center gap-2",onSubmit:h(k),children:[e.jsxs("div",{className:"flex flex-col w-[80%] m-auto gap-2",children:[e.jsx(n,{type:"email",autoComplete:"username",placeholder:"Email",...o("email",{required:!0})}),s.email&&e.jsx("span",{className:"text-red-500 text-sm",children:s.email.message}),e.jsxs("div",{className:"relative w-[100%] m-auto cursor-pointer",children:[e.jsx(n,{type:t?"text":"password",autoComplete:"current-password",placeholder:"password",...o("password",{required:!0})}),e.jsx("div",{type:"button",onClick:()=>p(r=>!r),className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-500",children:t?e.jsx("i",{className:"fa-solid fa-eye-slash w-2"}):e.jsx("i",{className:"fa-solid fa-eye"})})]}),s.password&&e.jsx("span",{className:"text-red-500 text-sm",children:s.password.message})]}),s.err&&e.jsx("span",{className:"text-red-500 text-sm",children:s.err.message}),e.jsx(S,{disabled:N,className:"block",type:"submit",children:"Đăng nhập"})]}),e.jsxs(B,{className:" flex flex-col",children:[e.jsx(i,{className:"",to:"/forgot-password",children:"Forgot PassWord?"}),e.jsxs("p",{children:["Bạn chưa có tài khoản? ",e.jsx(i,{to:"/register",children:"Đăng ký"})]})]})]})}export{H as default};
