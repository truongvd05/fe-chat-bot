import{u as y,a as b,r as c,b as v,j as s,I as i,B as C,N as n,s as S,c as E,d as m}from"./index-aeCwJNX1.js";import{C as L,a as q,b as I,c as V}from"./card-DPWbnyXO.js";import{u as _,o as B}from"./yup-COISer_V.js";const F=E({email:m().required("Vui lòng nhập Email"),password:m().required("Vui lòng nhập mật khẩu")});function M(){const d=y(),u=b(),[t,p]=c.useState(!1),{register:o,handleSubmit:h,setError:x,watch:l,clearErrors:g,formState:{errors:e}}=_({resolver:B(F)}),f=l("email"),w=l("password");c.useEffect(()=>{e.err&&g("err")},[f,w]);const[j,{isLoading:N,error:P}]=v(),k=async r=>{try{const a=await j({email:r.email,password:r.password}).unwrap();console.log("Login success:",a),localStorage.setItem("access_token",a.token.access_token),localStorage.setItem("refresh_token",a.token.refresh_token),u(S(a.user)),d("/home")}catch(a){console.log("Login failed:",a),x("err",{type:"manual",message:a?.data?.error||"Đăng nhập thất bại"})}};return s.jsxs(L,{className:"w-full max-w-sm m-auto",children:[s.jsx(q,{children:s.jsx(I,{className:"m-auto",children:"Log in with your account"})}),s.jsxs("form",{className:"flex flex-col items-center gap-2",onSubmit:h(k),children:[s.jsxs("div",{className:"flex flex-col w-[80%] m-auto gap-2",children:[s.jsx(i,{type:"email",autoComplete:"username",placeholder:"Email",...o("email",{required:!0})}),e.email&&s.jsx("span",{className:"text-red-500 text-sm",children:e.email.message}),s.jsxs("div",{className:"relative w-[100%] m-auto cursor-pointer",children:[s.jsx(i,{type:t?"text":"password",autoComplete:"current-password",placeholder:"password",...o("password",{required:!0})}),s.jsx("div",{type:"button",onClick:()=>p(r=>!r),className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-500",children:t?s.jsx("i",{className:"fa-solid fa-eye-slash w-2"}):s.jsx("i",{className:"fa-solid fa-eye"})})]}),e.password&&s.jsx("span",{className:"text-red-500 text-sm",children:e.password.message})]}),e.err&&s.jsx("span",{className:"text-red-500 text-sm",children:e.err.message}),s.jsx(C,{disabled:N,className:"block",type:"submit",children:"Đăng nhập"})]}),s.jsxs(V,{className:" flex flex-col",children:[s.jsx(n,{className:"",to:"/forgot-password",children:"Forgot PassWord?"}),s.jsxs("p",{children:["Bạn chưa có tài khoản? ",s.jsx(n,{to:"/register",children:"Đăng ký"})]})]})]})}export{M as default};
